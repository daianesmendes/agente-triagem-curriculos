{
  "name": "Agente de triagem de curr√≠culos",
  "nodes": [
    {
      "parameters": {
        "pollTimes": {
          "item": [
            {
              "mode": "everyMinute"
            }
          ]
        },
        "simple": false,
        "filters": {
          "q": "subject:Curr√≠culo"
        },
        "options": {
          "downloadAttachments": true
        }
      },
      "type": "n8n-nodes-base.gmailTrigger",
      "typeVersion": 1.3,
      "position": [
        -64,
        0
      ],
      "id": "f1d57a21-6cf0-4861-8423-4d465eaf0a6a",
      "name": "Gmail Trigger",
      "credentials": {
        "gmailOAuth2": {
          "id": "5TQoWyqhHw45WTLG",
          "name": "Gmail account Daiane"
        }
      }
    },
    {
      "parameters": {
        "operation": "pdf",
        "binaryPropertyName": "attachment_0",
        "options": {}
      },
      "type": "n8n-nodes-base.extractFromFile",
      "typeVersion": 1,
      "position": [
        160,
        0
      ],
      "id": "42dfa28d-0bcd-42b4-883b-e876e73cf456",
      "name": "Leitura do curr√≠culo"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "c665b663-a3d1-4587-85e7-b5c7b9756666",
              "name": "candidate_email",
              "value": "={{ $('Gmail Trigger').item.json.from.value[0].address }}",
              "type": "string"
            },
            {
              "id": "babbb9fa-06b3-4a8a-a4f0-8e2974783a04",
              "name": "resume_text",
              "value": "={{ $json.text }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        480,
        -144
      ],
      "id": "5c435f52-0f71-498c-b141-a5a2dac94986",
      "name": "Organizar dados do curr√≠culo"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "SUA_PLANILHA_ID_AQUI",
          "mode": "list",
          "cachedResultName": "Vagas 01tecnologia",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1J-800KvObcln9qWVs2UGotMR0uRC4-jaHN8g0jkeyoc/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "Sheet1",
          "mode": "name"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        480,
        144
      ],
      "id": "fa4fec79-769b-4253-9069-57d721d90a2c",
      "name": "Get row(s) in sheet",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "rWvJF7mRp0GEP4p7",
          "name": "Google Sheets account 7"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=",
        "options": {
          "systemMessage": "=Voc√™ √© um avaliador de recrutamento t√©cnico da empresa Obra Prima.\nSua fun√ß√£o √© analisar o curr√≠culo de um candidato e compar√°-lo com o perfil da vaga abaixo, que pode variar conforme os dados recebidos da planilha.\n\nüéØ Objetivo\n\nDevolva uma avalia√ß√£o completa e estruturada, contendo:\n\nPercentual de compatibilidade com a vaga (0 a 100%)\n\nPontos fortes (2 a 4 itens)\n\nPontos fracos (2 a 4 itens)\n\nRecomenda√ß√£o final (Ex: ‚ÄúAltamente indicado‚Äù, ‚ÄúIndicado para entrevista‚Äù, ‚ÄúN√£o indicado‚Äù)\n\n‚ö†Ô∏è Importante: Sempre inicie a resposta citando o nome da vaga analisada.\n\nüìã Como analisar\n\nSeja criterioso e objetivo.\nO candidato deve estar apto para atuar na fun√ß√£o descrita, considerando suas experi√™ncias, habilidades e forma√ß√£o.\nUse julgamento humano e infer√™ncia textual para comparar o curr√≠culo com as responsabilidades e requisitos da vaga.\n\nD√™ mais peso para experi√™ncia pr√°tica, resultados concretos e ader√™ncia √†s compet√™ncias t√©cnicas e comportamentais.\n\nüß© Estrutura da resposta\n\nResponda exatamente neste formato:\n\nüìå Vaga avaliada: [Nome exato da vaga]\n\nüìä Percentual de compatibilidade: XX%\n\n‚úÖ Pontos fortes:\n\n[item 1]\n\n[item 2]\n\n[item 3]\n\n‚ö†Ô∏è Pontos fracos:\n\n[item 1]\n\n[item 2]\n\n[item 3]\n\nüß≠ Recomenda√ß√£o final:\n[Explique em 2 a 3 linhas se o candidato deve seguir para entrevista, ou n√£o, e por qu√™]\n\nüíæ Dados fornecidos pelo sistema\n\nCurr√≠culo do candidato:\n{{ $json.resume_text }}\n\nVaga:\n{{ $json.vaga }}\n\nResponsabilidades:\n{{ $json.responsabilidades }}\n\nRequisitos:\n{{ $json.requisitos }}\n\nüí¨ Instru√ß√µes adicionais\n\nResponda somente no formato solicitado, sem coment√°rios fora da estrutura.\n\nCaso o curr√≠culo seja gen√©rico, superficial ou sem rela√ß√£o com a vaga, reduza o percentual de compatibilidade.\n\nEvite repetir trechos do curr√≠culo; fa√ßa an√°lise e s√≠ntese, com linguagem profissional e clara.\n\nüí° Exemplo de sa√≠da esperada\n\nüìå Vaga avaliada: Inside Sales\n\nüìä Percentual de compatibilidade: 82%\n\n‚úÖ Pontos fortes:\n\nExperi√™ncia comprovada em vendas consultivas B2B\n\nBoa comunica√ß√£o e postura consultiva\n\nExperi√™ncia com CRM e follow-ups estruturados\n\n‚ö†Ô∏è Pontos fracos:\n\nN√£o menciona uso do Pipedrive\n\nPouca rela√ß√£o com o setor de constru√ß√£o civil\n\nüß≠ Recomenda√ß√£o final:\nIndicado para entrevista. O candidato demonstra perfil compat√≠vel com Inside Sales e experi√™ncia s√≥lida em vendas SaaS, com potencial de r√°pida adapta√ß√£o ao segmento da Obra Prima."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2.2,
      "position": [
        992,
        0
      ],
      "id": "479f03eb-f653-4256-b550-ec0fb37ad81c",
      "name": "AI Agent"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4.1-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        992,
        192
      ],
      "id": "c2763b01-6175-4465-965d-347a75e1ef73",
      "name": "OpenAI Chat Model",
      "credentials": {
        "openAiApi": {
          "id": "x1vJgRPyMNjUHL92",
          "name": "OpenAi 2 - Daiane"
        }
      }
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineAll",
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        768,
        0
      ],
      "id": "6571d7fc-b1fe-43ed-b003-4780cfdfa1ae",
      "name": "Merge"
    },
    {
      "parameters": {
        "sendTo": "daiane.mendes@01tec.com.br",
        "subject": "=An√°lise de Curr√≠culo ‚Äì {{ $json[\"output\"].match(/Vaga avaliada:\\s*([^\\n]+)/)?.[1] || \"Vaga n√£o identificada\" }}",
        "message": "=<p>Ol√°, equipe de RH,</p>\n\n<p>Segue abaixo a an√°lise autom√°tica do curr√≠culo recebido:</p>\n\n<hr>\n\n<p><b>{{ $json[\"output\"].match(/Vaga avaliada:\\s*([^\\n]+)/)?.[1] || \"Vaga n√£o identificada\" }}</b></p>\n\n<pre style=\"font-family: Arial; white-space: pre-wrap;\">\n{{ $json[\"output\"] }}\n</pre>\n\n<p>Atenciosamente,<br>\n<b>Sistema de Triagem Autom√°tica ‚Äì Obra Prima</b></p>\n",
        "options": {
          "attachmentsUi": {
            "attachmentsBinary": [
              {
                "property": "attachment_0"
              }
            ]
          }
        }
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        2144,
        -208
      ],
      "id": "a757d699-eb62-40d5-be40-52b8dc0c5094",
      "name": "Send a message",
      "webhookId": "1f84a192-aad1-4fbb-ae66-96d9caa9dcba",
      "credentials": {
        "gmailOAuth2": {
          "id": "5TQoWyqhHw45WTLG",
          "name": "Gmail account Daiane"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const items = $input.all();\n\nconst parsed = items.map(i => {\n  const output = i.json.output || '';\n  const match = output.match(/(\\d+)%/); \n  const percent = match ? parseInt(match[1]) : 0;\n  return { ...i.json, compatibility: percent };\n});\n\nparsed.sort((a, b) => b.compatibility - a.compatibility);\n\nconst best = parsed[0];\n\nreturn [{ json: best }];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1344,
        0
      ],
      "id": "d0a652a0-9a68-47ed-b14f-a51e8fe78e86",
      "name": "vaga mais compat√≠vel"
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineByPosition",
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        1584,
        -16
      ],
      "id": "17e8273e-5feb-447e-8905-fbd106bf018e",
      "name": "Merge1"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "beca3109-be25-4954-85ea-277219816509",
              "leftValue": "={{ $json.compatibility }}",
              "rightValue": 60,
              "operator": {
                "type": "number",
                "operation": "gt"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        1792,
        -16
      ],
      "id": "144d0547-d5c4-435a-a6e4-2ce5856f49dc",
      "name": "If"
    },
    {
      "parameters": {
        "sendTo": "rh@empresa.com",
        "subject": "=An√°lise de Curr√≠culo ‚Äì Sem vaga compat√≠vel",
        "message": "=<p>Ol√°, equipe de RH,</p>\n\n<p>Segue abaixo o parecer da an√°lise autom√°tica do curr√≠culo recebido.</p>\n\n<p>Ap√≥s a triagem, n√£o foram identificadas vagas que se enquadrem no perfil do candidato neste momento.</p>\n\n<p>Recomendamos manter o curr√≠culo arquivado para futuras oportunidades que estejam alinhadas √†s qualifica√ß√µes apresentadas.</p>\n\n<p>Atenciosamente,<br>\n<b>Sistema de Triagem Autom√°tica ‚Äì Obra Prima</b></p>",
        "options": {
          "attachmentsUi": {
            "attachmentsBinary": [
              {
                "property": "attachment_0"
              }
            ]
          }
        }
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        2144,
        176
      ],
      "id": "c24f86a8-5ebd-4ce0-abf1-d2a9fe403c84",
      "name": "Send a message1",
      "webhookId": "1f84a192-aad1-4fbb-ae66-96d9caa9dcba",
      "credentials": {
        "gmailOAuth2": {
          "id": "5TQoWyqhHw45WTLG",
          "name": "Gmail account Daiane"
        }
      }
    }
  ],
  "pinData": {},
  "connections": {
    "Gmail Trigger": {
      "main": [
        [
          {
            "node": "Leitura do curr√≠culo",
            "type": "main",
            "index": 0
          },
          {
            "node": "Merge1",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Leitura do curr√≠culo": {
      "main": [
        [
          {
            "node": "Organizar dados do curr√≠culo",
            "type": "main",
            "index": 0
          },
          {
            "node": "Get row(s) in sheet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Organizar dados do curr√≠culo": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Merge": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent": {
      "main": [
        [
          {
            "node": "vaga mais compat√≠vel",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "vaga mais compat√≠vel": {
      "main": [
        [
          {
            "node": "Merge1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send a message": {
      "main": [
        []
      ]
    },
    "Merge1": {
      "main": [
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If": {
      "main": [
        [
          {
            "node": "Send a message",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Send a message1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "94564ba3-7b1d-4222-94dc-28f1b1166dfb",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "333f7fdede98953d71017ef2e0ac27e5543ae79f7724abd686718654a6707bfd"
  },
  "id": "b1Hyj44IYs9SiDhF",
  "tags": []
}